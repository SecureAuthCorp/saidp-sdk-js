function saConfig(t,e,r,n){return this.realm=t,this.appServer=e,this.appID=r,this.appKey=n,this}function buildAuthHeader(t,e,r,n,i,s){var o=[];o.push(t),o.push(e),o.push(i),o.push(r),n.trim().length>1&&o.push(n);var a=o.join("\n"),u=new jsSHA(a,"TEXT"),h=u.getHMAC(s,"HEX","SHA-256","B64"),c=i+":"+h,p=window.btoa(unescape(encodeURIComponent(c)));return p}function buildURI(t,e,r,n,i){return t?e.indexOf("$")>1?r+"/"+n+"/"+e.replace("$USER$",i):r+"/"+n+"/"+e:e.indexOf("$")>1?"/"+n+"/"+e.replace("$USER$",i):"/"+n+"/"+e}function secureAuthApi(t,e,r,n,i){this.actionName=e,this.config=t,this.props=r,n?this.success=n:this.success=function(){},i?this.error=i:this.error=function(){},this.throwError=[],this.action={}}var CryptoJS=CryptoJS||function(t,e){var r={},n=r.lib={},i=function(){},s=n.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=n.WordArray=s.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var i=0;t>i;i++)e[n+i>>>2]|=(r[i>>>2]>>>24-8*(i%4)&255)<<24-8*((n+i)%4);else if(65535<r.length)for(i=0;t>i;i+=4)e[n+i>>>2]=r[i>>>2];else e.push.apply(e,r);return this.sigBytes+=t,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-8*(r%4),e.length=t.ceil(r/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],n=0;e>n;n+=4)r.push(4294967296*t.random()|0);return new o.init(r,e)}}),a=r.enc={},u=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],n=0;t>n;n++){var i=e[n>>>2]>>>24-8*(n%4)&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,r=[],n=0;e>n;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-4*(n%8);return new o.init(r,e/2)}},h=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],n=0;t>n;n++)r.push(String.fromCharCode(e[n>>>2]>>>24-8*(n%4)&255));return r.join("")},parse:function(t){for(var e=t.length,r=[],n=0;e>n;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-8*(n%4);return new o.init(r,e)}},c=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},p=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=c.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,n=r.words,i=r.sigBytes,s=this.blockSize,a=i/(4*s),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0);if(e=a*s,i=t.min(4*e,i),e){for(var u=0;e>u;u+=s)this._doProcessBlock(n,u);u=n.splice(0,e),r.sigBytes-=i}return new o.init(u,i)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=p.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new f.HMAC.init(t,r).finalize(e)}}});var f=r.algo={};return r}(Math);!function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,n=this._map;t.clamp(),t=[];for(var i=0;r>i;i+=3)for(var s=(e[i>>>2]>>>24-8*(i%4)&255)<<16|(e[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|e[i+2>>>2]>>>24-8*((i+2)%4)&255,o=0;4>o&&r>i+.75*o;o++)t.push(n.charAt(s>>>6*(3-o)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var r=t.length,n=this._map,i=n.charAt(64);i&&(i=t.indexOf(i),-1!=i&&(r=i));for(var i=[],s=0,o=0;r>o;o++)if(o%4){var a=n.indexOf(t.charAt(o-1))<<2*(o%4),u=n.indexOf(t.charAt(o))>>>6-2*(o%4);i[s>>>2]|=(a|u)<<24-8*(s%4),s++}return e.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,c){var p=0,f=[0],l="",d=null,l=c||"UTF8";if("UTF8"!==l&&"UTF16BE"!==l&&"UTF16LE"!==l)throw"encoding must be UTF8, UTF16BE, or UTF16LE";if("HEX"===e){if(0!==t.length%2)throw"srcString of HEX type must be in byte increments";d=n(t),p=d.binLen,f=d.value}else if("TEXT"===e||"ASCII"===e)d=r(t,l),p=d.binLen,f=d.value;else if("B64"===e)d=s(t),p=d.binLen,f=d.value;else{if("BYTES"!==e)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";d=i(t),p=d.binLen,f=d.value}this.getHash=function(t,e,r,n){var i,s=null,c=f.slice(),l=p;if(3===arguments.length?"number"!=typeof r&&(n=r,r=1):2===arguments.length&&(r=1),r!==parseInt(r,10)||1>r)throw"numRounds must a integer >= 1";switch(e){case"HEX":s=o;break;case"B64":s=a;break;case"BYTES":s=u;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-224"===t)for(i=0;r>i;i+=1)c=w(c,l,t),l=224;else{if("SHA-256"!==t)throw"Chosen SHA variant is not supported";for(i=0;r>i;i+=1)c=w(c,l,t),l=256}return s(c,h(n))},this.getHMAC=function(t,e,c,d,g){var v,m,b,y,S=[],A=[];switch(v=null,d){case"HEX":d=o;break;case"B64":d=a;break;case"BYTES":d=u;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-224"===c)m=64,y=224;else{if("SHA-256"!==c)throw"Chosen SHA variant is not supported";m=64,y=256}if("HEX"===e)v=n(t),b=v.binLen,v=v.value;else if("TEXT"===e||"ASCII"===e)v=r(t,l),b=v.binLen,v=v.value;else if("B64"===e)v=s(t),b=v.binLen,v=v.value;else{if("BYTES"!==e)throw"inputFormat must be HEX, TEXT, ASCII, B64, or BYTES";v=i(t),b=v.binLen,v=v.value}if(t=8*m,e=m/4-1,b/8>m){for(v=w(v,b,c);v.length<=e;)v.push(0);v[e]&=4294967040}else if(m>b/8){for(;v.length<=e;)v.push(0);v[e]&=4294967040}for(m=0;e>=m;m+=1)S[m]=909522486^v[m],A[m]=1549556828^v[m];return c=w(A.concat(w(S.concat(f),t+p,c)),t+y,c),d(c,h(g))}}function r(t,e){var r,n,i,s,o=[],a=[],u=0;if("UTF8"===e)for(n=0;n<t.length;n+=1)for(r=t.charCodeAt(n),a=[],128>r?a.push(r):2048>r?(a.push(192|r>>>6),a.push(128|63&r)):55296>r||r>=57344?a.push(224|r>>>12,128|r>>>6&63,128|63&r):(n+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),a.push(240|r>>>18,128|r>>>12&63,128|r>>>6&63,128|63&r)),i=0;i<a.length;i+=1){for(s=u>>>2;o.length<=s;)o.push(0);o[s]|=a[i]<<24-u%4*8,u+=1}else if("UTF16BE"===e||"UTF16LE"===e)for(n=0;n<t.length;n+=1){for(r=t.charCodeAt(n),"UTF16LE"===e&&(i=255&r,r=i<<8|r>>8),s=u>>>2;o.length<=s;)o.push(0);o[s]|=r<<16-u%4*8,u+=2}return{value:o,binLen:8*u}}function n(t){var e,r,n,i=[],s=t.length;if(0!==s%2)throw"String of HEX type must be in byte increments";for(e=0;s>e;e+=2){if(r=parseInt(t.substr(e,2),16),isNaN(r))throw"String of HEX type contains invalid characters";for(n=e>>>3;i.length<=n;)i.push(0);i[e>>>3]|=r<<24-e%8*4}return{value:i,binLen:4*s}}function i(t){var e,r,n,i=[];for(r=0;r<t.length;r+=1)e=t.charCodeAt(r),n=r>>>2,i.length<=n&&i.push(0),i[n]|=e<<24-r%4*8;return{value:i,binLen:8*t.length}}function s(t){var e,r,n,i,s,o=[],a=0;if(-1===t.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(r=t.indexOf("="),t=t.replace(/\=/g,""),-1!==r&&r<t.length)throw"Invalid '=' found in base-64 string";for(r=0;r<t.length;r+=4){for(s=t.substr(r,4),n=i=0;n<s.length;n+=1)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(s[n]),i|=e<<18-6*n;for(n=0;n<s.length-1;n+=1){for(e=a>>>2;o.length<=e;)o.push(0);o[e]|=(i>>>16-8*n&255)<<24-a%4*8,a+=1}}return{value:o,binLen:8*a}}function o(t,e){var r,n,i="",s=4*t.length;for(r=0;s>r;r+=1)n=t[r>>>2]>>>8*(3-r%4),i+="0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n);return e.outputUpper?i.toUpperCase():i}function a(t,e){var r,n,i,s="",o=4*t.length;for(r=0;o>r;r+=3)for(i=r+1>>>2,n=t.length<=i?0:t[i],i=r+2>>>2,i=t.length<=i?0:t[i],i=(t[r>>>2]>>>8*(3-r%4)&255)<<16|(n>>>8*(3-(r+1)%4)&255)<<8|i>>>8*(3-(r+2)%4)&255,n=0;4>n;n+=1)s=8*r+6*n<=32*t.length?s+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-n)&63):s+e.b64Pad;return s}function u(t){var e,r,n="",i=4*t.length;for(e=0;i>e;e+=1)r=t[e>>>2]>>>8*(3-e%4)&255,n+=String.fromCharCode(r);return n}function h(t){var e={outputUpper:!1,b64Pad:"="};try{t.hasOwnProperty("outputUpper")&&(e.outputUpper=t.outputUpper),t.hasOwnProperty("b64Pad")&&(e.b64Pad=t.b64Pad)}catch(r){}if("boolean"!=typeof e.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof e.b64Pad)throw"Invalid b64Pad formatting option";return e}function c(t,e){return t>>>e|t<<32-e}function p(t,e,r){return t&e^~t&r}function f(t,e,r){return t&e^t&r^e&r}function l(t){return c(t,2)^c(t,13)^c(t,22)}function d(t){return c(t,6)^c(t,11)^c(t,25)}function g(t){return c(t,7)^c(t,18)^t>>>3}function v(t){return c(t,17)^c(t,19)^t>>>10}function m(t,e){var r=(65535&t)+(65535&e);return((t>>>16)+(e>>>16)+(r>>>16)&65535)<<16|65535&r}function b(t,e,r,n){var i=(65535&t)+(65535&e)+(65535&r)+(65535&n);return((t>>>16)+(e>>>16)+(r>>>16)+(n>>>16)+(i>>>16)&65535)<<16|65535&i}function y(t,e,r,n,i){var s=(65535&t)+(65535&e)+(65535&r)+(65535&n)+(65535&i);return((t>>>16)+(e>>>16)+(r>>>16)+(n>>>16)+(i>>>16)+(s>>>16)&65535)<<16|65535&s}function w(t,e,r){var n,i,s,o,a,u,h,c,w,S,A,T,E,H,U,B,$,_,P,I,O,X,x,C,L,k,R=[],F=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(S=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],i=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],"SHA-224"!==r&&"SHA-256"!==r)throw"Unexpected error in SHA-2 implementation";for(A=64,n=(e+65>>>9<<4)+15,H=16,U=1,L=Number,B=m,$=b,_=y,P=g,I=v,O=l,X=d,C=f,x=p,S="SHA-224"===r?S:i;t.length<=n;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[n]=e,k=t.length,T=0;k>T;T+=H){for(e=S[0],n=S[1],i=S[2],s=S[3],o=S[4],a=S[5],u=S[6],h=S[7],E=0;A>E;E+=1)16>E?(w=E*U+T,c=t.length<=w?0:t[w],w=t.length<=w+1?0:t[w+1],R[E]=new L(c,w)):R[E]=$(I(R[E-2]),R[E-7],P(R[E-15]),R[E-16]),c=_(h,X(o),x(o,a,u),F[E],R[E]),w=B(O(e),C(e,n,i)),h=u,u=a,a=o,o=B(s,c),s=i,i=n,n=e,e=B(c,w);S[0]=B(e,S[0]),S[1]=B(n,S[1]),S[2]=B(i,S[2]),S[3]=B(s,S[3]),S[4]=B(o,S[4]),S[5]=B(a,S[5]),S[6]=B(u,S[6]),S[7]=B(h,S[7])}if("SHA-224"===r)t=[S[0],S[1],S[2],S[3],S[4],S[5],S[6]];else{if("SHA-256"!==r)throw"Unexpected error in SHA-2 implementation";t=S}return t}"function"==typeof define&&define.amd?define(function(){return e}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=e:exports=e:t.jsSHA=e}(this),secureAuthApi.prototype={constructor:secureAuthApi,actions:{user_only:{url:"api/v1/auth",method:"POST",properties:{type:"user_id",user_id:"$USER$"}},user_password:{url:"api/v1/auth",method:"POST",properties:{user_id:"$USER$",type:"password",token:"$PWD$"}},get_factors:{url:"api/v1/users/$USER$/factors",method:"GET",properties:{}},submit_factors:{url:"api/v1/auth",method:"POST",properties:{user_id:"$USER$",type:"$OTP$",factor_id:"$ID$",token:"$TOKEN$"}},ip_eval:{url:"api/v1/ipeval",method:"POST",properties:{user_id:"$USER$",type:"risk",ip_address:"$IP$"}}},isNullorUndefined:function(t){try{return void 0===t||t.length<1||null===t||t.trim().length<1?!0:!1}catch(e){return!0}},toArray:function(t){for(var e=Object.keys(t),r=[],n=0;e>n;n++)r.push(n+":"+e[n]);return console.info(r),r},matchProperty:function(){for(var t=Object.keys(this.action.properties),e=0;e<t.length;e++)if(this.action.properties[t[e]].indexOf("$")>-1)switch(this.action.properties[t[e]]){case"$USER$":this.action.properties[t[e]]=this.props.user;break;case"$PWD$":this.action.properties[t[e]]=this.props.password;break;case"$OTP$":this.action.properties[t[e]]=this.props.type;break;case"$TOKEN$":this.action.properties[t[e]]=this.props.token;break;case"$ID$":this.action.properties[t[e]]=this.props.factor_id;break;case"$IP$":this.action.properties[t[e]]=this.props.ip_address}console.warn(this.action.properties)},loadInit:function(){(this.isNullorUndefined(this.config.realm)||this.isNullorUndefined(this.config.appServer)||this.isNullorUndefined(this.config.appID)||this.isNullorUndefined(this.config.appKey))&&this.throwError.push({status:"error",message:"The SecureAuthApi configuration was not properly configured. Please ensure you have included the Server URL, SecureAuth Realm, App ID, and App Key"}),this.getProperties()},getAction:function(){if(this.isNullorUndefined(this.actionName))this.throwError.push({status:"error",message:"There was no action. An action must be submitted to ensure proper responses."});else switch(this.actionName.toLowerCase()){case"user":this.action=this.actions.user_only;break;case"pwd":this.action=this.actions.user_password;break;case"get-2fa":this.action=this.actions.get_factors;break;case"sub-2fa":this.action=this.actions.submit_factors;break;case"ipeval":this.action=this.actions.ip_eval}},getProperties:function(){this.isNullorUndefined(this.action.url)&&this.getAction(),this.isNullorUndefined(this.props)&&!this.isNullorUndefined(this.action.properties)?this.throwError.push({status:"error",message:"There were no properties submitted and this action requires properties."}):this.matchProperty()},XMLHttpFactories:[function(){return new XMLHttpRequest},function(){return new XDomainRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],createXMLHTTPObject:function(){for(var t=!1,e=0;e<this.XMLHttpFactories.length;e++){try{t=this.XMLHttpFactories[e]()}catch(r){continue}break}return t},submit:function(){var t=this.createXMLHTTPObject();t||this.throwError.push({status:"error",message:"Failed to create the request. This was due to the browsers inability to support the request."});var e=(new Date).toUTCString(),r=buildAuthHeader(this.action.method,e,buildURI(!1,this.action.url,this.config.appServer,this.config.realm,this.props.user),"POST"===this.action.method?JSON.stringify(this.action.properties):"",this.config.appID,this.config.appKey);t.open(this.action.method,buildURI(!0,this.action.url,this.config.appServer,this.config.realm,this.props.user),!0),t.setRequestHeader("Authorization","Basic "+r),t.setRequestHeader("X-SA-Date",e),t.setRequestHeader("Content-type","application/json; charset=UTF-8");var n=this.success,i=this.error;t.onreadystatechange=function(){return 4==t.readyState?200!=t.status&&304!=t.status?void i(t):void n(null,t):void 0},4!=t.readyState&&t.send("POST"===this.action.method?JSON.stringify(this.action.properties):null)},send:function(){return this.isNullorUndefined(this.throwError)?(this.getProperties(),void this.submit()):this.error(this.throwError)}};